# Схема подключения

## ESP32 GPIO

| GPIO | Назначение       | Направление |
|------|------------------|-------------|
| 0    | EN (TMC2209)     | OUTPUT      |
| 1    | STEP             | OUTPUT      |
| 2    | DIR              | OUTPUT      |
| 4    | UART TX (TMC2209)| OUTPUT      |
| 5    | UART RX (TMC2209)| INPUT       |
| 8    | I2C SDA          | —           |
| 9    | I2C SCL          | —           |

UART для TMC2209 — HardwareSerial(1), 115200 бод.

## I2C шина (SDA=8, SCL=9)

| Адрес | Устройство       | Примечание                        |
|-------|------------------|-----------------------------------|
| 0x20  | PCF8574          | Может быть 0x21, проверяем оба    |
| 0x3C  | SSD1306 OLED     | 128x64                            |
| 0x53  | ADXL345          | Может быть 0x1D (если SDO=HIGH)   |

## PCF8574 — распиновка

| Пин | Назначение | Режим  | Примечание                   |
|-----|------------|--------|------------------------------|
| P1  | LED        | OUTPUT | Индикация                    |
| P2  | ENC_CLK    | INPUT  | Энкодер — CLK                |
| P3  | ENC_DT     | INPUT  | Энкодер — DT                 |
| P4  | ENC_SW     | INPUT  | Энкодер — кнопка             |
| P5  | ENDSTOP_1  | INPUT  | Концевик 1, active LOW       |
| P6  | ENDSTOP_2  | INPUT  | Концевик 2, active LOW       |

P0 — не работает (физический пин вырван на плате экспандера). P7 — не используется.

Важно: PCF8574 при write() делает read-modify-write всего порта.
Если входные пины притянуты к земле, write() одного пина может сбросить pull-up на остальных.
Для записи использовать `write8()` с полным байтом, где все входы = HIGH.

## TMC2209

- R_SENSE: 0.11 Ом
- Адрес драйвера: 0b00
- Микрошаги: 32
- Режим: StealthChop (spreadCycle выключен)
- Ток по умолчанию: 800 мА (диапазон 200–1500 мА)
- toff: 4

## ADXL345

- Full resolution, +-2g (3.9 mg/LSB)
- Частота: 100 Hz
- DEVID: 0xE5 (для проверки)

Ориентация на слайдере:
- **Z** — ось движения слайдера
- **X** — вверх
- **Y** — в сторону камеры (направление съёмки)
