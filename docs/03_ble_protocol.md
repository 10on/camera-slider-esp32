# BLE-протокол

Имя устройства: **Camera_Slider**

## Сервис

UUID: `4fafc201-1fb5-459e-8fcc-c5c9c331914b`

## Характеристики

### Command (WRITE)
UUID: `beb5483e-36e1-4688-b7f5-ea07361b26a8`

1 байт — код команды:

| Байт | Команда  | Действие                                      |
|------|----------|-----------------------------------------------|
| 'F'  | Forward  | Непрерывное движение вперёд                   |
| 'B'  | Backward | Непрерывное движение назад                    |
| 'S'  | Stop     | Остановка любого движения                     |
| 'H'  | Home     | Запуск калибровки (хоминг)                    |

F и B игнорируются во время хоминга или движения к позиции.

### Speed (WRITE)
UUID: `d8de624e-140f-4a22-8594-e2216b84a5f2`

2 байта, uint16, little-endian — задержка между шагами в микросекундах.

```
[low_byte, high_byte]
```

Диапазон: 100–5000. Меньше = быстрее.

### Position (WRITE)
UUID: `a1b2c3d4-e5f6-4789-a012-3456789abcde`

4 байта, int32, little-endian — целевая позиция в шагах.

```
[byte0, byte1, byte2, byte3]
```

Ограничивается в [0, travelDistance]. Требуется калибровка. Без неё — команда игнорируется.

### Current (WRITE)
UUID: `f1e2d3c4-b5a6-4978-9012-3456789abcde`

2 байта, uint16, little-endian — ток мотора в мА.

```
[low_byte, high_byte]
```

Диапазон: 200–1500. Применяется мгновенно.

### Status (READ / NOTIFY)
UUID: `1c95d5e3-d8f7-413a-bf3d-7a2e5d7be87e`

9 байт, отправляется notify каждые 100мс при активном соединении.

```
Байты 0–3: currentPosition (int32, little-endian)
Байт  4:   флаги (битовая маска)
Байты 5–8: travelDistance (int32, little-endian)
```

Битовая маска (байт 4):

| Бит | Маска | Значение                |
|-----|-------|-------------------------|
| 0   | 0x01  | ENDSTOP_1 сработал      |
| 1   | 0x02  | ENDSTOP_2 сработал      |
| 2   | 0x04  | Идёт хоминг             |
| 3   | 0x08  | Калибровка выполнена     |
| 4   | 0x10  | Движение к позиции       |
